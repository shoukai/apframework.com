---
title: 'LangChain å¤šæ™ºèƒ½ä½“æ¶æ„ï¼šæ·±å…¥è§£æ Supervisor ä¸ Handoffs æ¨¡å¼'
date: '2025-12-09'
tags: ['LangChain', 'LangGraph', 'Multi-Agent', 'Supervisor', 'AI Architecture', 'Python', 'Agentic Patterns']
draft: false
summary: 'æ·±å…¥æ¢è®¨ LangChain å¤šæ™ºèƒ½ä½“æ¶æ„çš„æ ¸å¿ƒæ¨¡å¼ï¼Œä»é›†ä¸­å¼çš„ Supervisor åˆ°å»ä¸­å¿ƒåŒ–çš„ Handoffsã€‚æœ¬æ–‡ç»“åˆä»£ç ç¤ºä¾‹ï¼Œè§£æå¦‚ä½•æ„å»ºå…·å¤‡å·¥å…·æ²»ç†ã€ä¸Šä¸‹æ–‡æ„ŸçŸ¥ä¸å±‚çº§åä½œèƒ½åŠ›çš„å¤æ‚ AI ç³»ç»Ÿã€‚'
---

<div className="text-center">
  <img src="/static/images/2025-12-09-LangChain-Multi-agent/marvin-meyer-SYTO3xs06fU-unsplash.jpg" alt="Free" />
  <p>Multi-agentï¼ˆPhoto by <a href="https://unsplash.com/@marvelous?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">Marvin Meyer</a> on <a href="https://unsplash.com/photos/people-sitting-down-near-table-with-assorted-laptop-computers-SYTO3xs06fU?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">Unsplash</a>ï¼‰</p>
</div>

## ç›®å½•
<TOCInline toc={props.toc} exclude="æ¦‚è¿°" toHeading={3} />

## 1. Multi-agent å¤šæ™ºèƒ½ä½“ç³»ç»Ÿ

å¤šæ™ºèƒ½ä½“ç³»ç»Ÿï¼ˆMulti-Agent Systemsï¼‰å°†å¤æ‚çš„åº”ç”¨ç¨‹åºæ‹†è§£ä¸ºå¤šä¸ªå„å¸å…¶èŒçš„ä¸“ä¸šæ™ºèƒ½ä½“ï¼Œé€šè¿‡åä½œæ¥å…±åŒè§£å†³é—®é¢˜ã€‚è¿™ç§æ¶æ„ä¸å†ä¾èµ–å•ä¸€çš„â€œè¶…çº§æ™ºèƒ½ä½“â€æ¥å¤„ç†æ‰€æœ‰æ­¥éª¤ï¼Œè€Œæ˜¯å°†ä»»åŠ¡åˆ†é…ç»™æ›´å°ã€æ›´ä¸“æ³¨çš„æ™ºèƒ½ä½“å•å…ƒï¼Œç»„åˆæˆåè°ƒæœ‰åºçš„å·¥ä½œæµã€‚

å¤šæ™ºèƒ½ä½“ç³»ç»Ÿåœ¨ä»¥ä¸‹åœºæ™¯ä¸­å°¤ä¸ºé€‚ç”¨ï¼š

- **å·¥å…·æ²»ç†**ï¼šå½“å•ä¸ªæ™ºèƒ½ä½“æŒ‚è½½äº†è¿‡å¤šå·¥å…·ï¼Œå¯¼è‡´å…¶åœ¨å·¥å…·é€‰æ‹©ä¸Šå®¹æ˜“å‡ºç°å¹»è§‰æˆ–å†³ç­–å¤±è¯¯æ—¶ã€‚
- **ä¸Šä¸‹æ–‡ç®¡ç†**ï¼šå½“ä»»åŠ¡ä¸Šä¸‹æ–‡æˆ–è®°å¿†åº“è¿‡äºåºå¤§ï¼Œå•ä¸ªæ™ºèƒ½ä½“éš¾ä»¥æœ‰æ•ˆè¿½è¸ªå’Œå¤„ç†æ—¶ã€‚
- **ä¸“ä¸šåˆ†å·¥**ï¼šå½“ä»»åŠ¡éœ€è¦æˆªç„¶ä¸åŒçš„è§’è‰²èƒ½åŠ›ï¼ˆä¾‹å¦‚ï¼šè§„åˆ’å¸ˆã€ç ”ç©¶å‘˜ã€æ•°å­¦ä¸“å®¶ï¼‰åä½œå®Œæˆæ—¶ã€‚


## 2. Multi-agent patterns  å¤šæ™ºèƒ½ä½“æ¨¡å¼

åœ¨æ¨¡å¼è®¾è®¡å±‚é¢ï¼Œå¤šæ™ºèƒ½ä½“ç³»ç»Ÿé€šå¸¸é‡‡ç”¨ä¸¤ç§åä½œèŒƒå¼ï¼šé›†ä¸­ç¼–æ’çš„ **â€œå·¥å…·è°ƒç”¨ï¼ˆTool callingï¼‰â€** ä¸å»ä¸­å¿ƒåŒ–çš„ **â€œäº¤æ¥ï¼ˆHandoffsï¼‰â€**ã€‚æ ¹æ®ä¸šåŠ¡å¯¹ä¸€è‡´æ€§ä¸çµæ´»æ€§çš„ä¸åŒè¯‰æ±‚ï¼Œé€‰æ‹©åˆé€‚çš„æ¨¡å¼å¯æ˜¾è‘—æ”¹å–„ç³»ç»Ÿè¡¨ç°ã€‚

**ä¸»ç®¡æ¨¡å¼ï¼ˆSupervisorï¼‰** æ˜¯å·¥å…·è°ƒç”¨çš„å…¸å‹ä»£è¡¨ï¼Œä¸»ç®¡æ™ºèƒ½ä½“å°†å…¶ä»–æ™ºèƒ½ä½“è§†ä¸ºâ€œå·¥å…·â€è¿›è¡Œè°ƒç”¨ã€‚è¿™äº›â€œå·¥å…·â€æ™ºèƒ½ä½“é€šå¸¸ä¸ç›´æ¥ä¸ç”¨æˆ·äº¤äº’ï¼Œè€Œæ˜¯ä¸“æ³¨äºæ‰§è¡Œä»»åŠ¡å¹¶è¿”å›ç»“æœã€‚è¿™æ˜¯ä¸€ç§é›†ä¸­å¼çš„è·¯ç”±ç®¡ç†æ–¹å¼ã€‚

### Tool calling  å·¥å…·è°ƒç”¨

å½“ä¸€ä¸ªâ€œæ§åˆ¶å™¨æ™ºèƒ½ä½“â€éœ€è¦ç»Ÿä¸€è°ƒåº¦å¤šä¸ªâ€œå·¥å…·å‹æ™ºèƒ½ä½“â€æ—¶ï¼Œå·¥å…·è°ƒç”¨æ¨¡å¼æ›´åˆ©äºä¿è¯æµç¨‹çš„ä¸€è‡´æ€§ä¸å®‰å…¨æ€§ã€‚æ§åˆ¶å™¨ï¼ˆControllerï¼‰è´Ÿè´£è·¯ç”±åˆ†å‘ä¸çŠ¶æ€ç®¡ç†ï¼Œè€Œå·¥å…·å‹æ™ºèƒ½ä½“åˆ™ä¸“æ³¨äºå…·ä½“ä»»åŠ¡çš„æ‰§è¡Œã€‚

**å·¥ä½œæµï¼š**
1. æ§åˆ¶å™¨æ¥æ”¶è¾“å…¥ï¼Œå¹¶å†³å®šè°ƒç”¨å“ªä¸ªå·¥å…·ï¼ˆæˆ–å­æ™ºèƒ½ä½“ï¼‰ã€‚
2. å·¥å…·æ™ºèƒ½ä½“æ ¹æ®æŒ‡ä»¤æ‰§è¡Œä»»åŠ¡ã€‚
3. å·¥å…·æ™ºèƒ½ä½“å°†ç»“æœè¿”å›ç»™æ§åˆ¶å™¨ã€‚
4. æ§åˆ¶å™¨åŸºäºç»“æœå†³å®šä¸‹ä¸€æ­¥è¡ŒåŠ¨æˆ–ç»“æŸä»»åŠ¡ã€‚

![](/static/images/2025-12-09-LangChain-Multi-agent/iShot_2025-12-10_00.05.43.png)

*å›¾æ³¨ï¼šä½œä¸ºå·¥å…·çš„æ™ºèƒ½ä½“é€šå¸¸ä¸éœ€è¦å…·å¤‡å¯¹è¯èƒ½åŠ›ï¼Œå®ƒä»¬çš„æ ¸å¿ƒèŒè´£æ˜¯â€œæ‰§è¡Œå¹¶åé¦ˆâ€ã€‚è‹¥éœ€è¦å­æ™ºèƒ½ä½“ç›´æ¥ä¸ç”¨æˆ·å¯¹è¯ï¼Œåˆ™åº”è€ƒè™‘äº¤æ¥æ¨¡å¼ã€‚*

### Handoffs  äº¤æ¥

å½“ä»»åŠ¡éœ€è¦åœ¨ä¸åŒæ™ºèƒ½ä½“é—´åˆ‡æ¢â€œä¸»å¯¼æƒâ€ï¼ˆä¾‹å¦‚ï¼šå…ˆç”±ç ”ç©¶å‘˜æ£€ç´¢ï¼Œå†è½¬äº¤ç»™åˆ†æå¸ˆè®¡ç®—ï¼Œæœ€åç”±ç¼–è¾‘æ±‡æ€»ï¼‰ï¼Œäº¤æ¥æ¨¡å¼æä¾›äº†æ›´çµæ´»çš„åä½œèƒ½åŠ›ã€‚å½“å‰å¤„äºâ€œæ´»è·ƒâ€çŠ¶æ€çš„æ™ºèƒ½ä½“ç›´æ¥ä¸ç”¨æˆ·äº¤äº’ï¼Œå¹¶åœ¨é€‚å½“æ—¶æœºå°†æ§åˆ¶æƒï¼ˆåŠä¸Šä¸‹æ–‡ï¼‰ç§»äº¤ç»™ä¸‹ä¸€ä¸ªæ™ºèƒ½ä½“ã€‚

è¿™ç§æ¨¡å¼æ˜¯å»ä¸­å¿ƒåŒ–çš„ï¼šæ™ºèƒ½ä½“å¯ä»¥è‡ªä¸»å†³å®šâ€œè°æ˜¯ä¸‹ä¸€ä¸ªæ´»è·ƒè€…â€ã€‚

**å·¥ä½œæµï¼š**
1. å½“å‰æ™ºèƒ½ä½“åˆ¤æ–­éœ€è¦å…¶ä»–è§’è‰²çš„ååŠ©ã€‚
2. å®ƒå°†æ§åˆ¶æƒï¼ˆä»¥åŠå½“å‰çŠ¶æ€ï¼‰ä¼ é€’ç»™ä¸‹ä¸€ä¸ªæ™ºèƒ½ä½“ã€‚
3. æ–°çš„æ™ºèƒ½ä½“æ¥ç®¡å¯¹è¯ï¼Œç›´æ¥ä¸ç”¨æˆ·äº¤äº’ï¼Œç›´åˆ°å®ƒå†³å®šå†æ¬¡äº¤æ¥æˆ–å®Œæˆä»»åŠ¡ã€‚

![](/static/images/2025-12-09-LangChain-Multi-agent/iShot_2025-12-10_00.05.03.png)

## 3. ä¸»ç®¡æ¨¡å¼ï¼ˆSupervisor Patternï¼‰

ä¸»ç®¡æ¨¡å¼ï¼ˆSupervisor Patternï¼‰é€šè¿‡å¼•å…¥ä¸€ä¸ªâ€œæ€»æ§æ™ºèƒ½ä½“â€æ¥ç¼–æ’å¤šä¸ªä¸“ä¸šæ™ºèƒ½ä½“ï¼Œéå¸¸é€‚ç”¨äºè·¨è§’è‰²åˆ†å·¥çš„ç«¯åˆ°ç«¯æµç¨‹ã€‚ç›¸æ¯”äºè®©ä¸€ä¸ªå•ä½“æ™ºèƒ½ä½“åœ¨æ•°åä¸ªå·¥å…·ä¸­è‰°éš¾é€‰æ‹©ï¼Œä¸»ç®¡æ¨¡å¼æ˜ç¡®äº†â€œè°è´Ÿè´£ä»€ä¹ˆâ€ï¼Œæ—¢ä¿ç•™äº†å…¨å±€æŠŠæ§èƒ½åŠ›ï¼Œåˆå®ç°äº†èƒ½åŠ›çš„è§£è€¦ã€‚

å®ƒå¹¶éæ„å»ºä¸€ä¸ªè¯•å›¾æŒæ¡æ‰€æœ‰é¢†åŸŸçš„å…¨èƒ½æ™ºèƒ½ä½“ï¼Œè€Œæ˜¯åˆ›å»ºä¸€ä¸ªäº†è§£æ•´ä½“å·¥ä½œæµçš„ç®¡ç†è€…ï¼Œç”±å®ƒæ¥åè°ƒå„ä¸ªé¢†åŸŸçš„ä¸“å®¶ã€‚

**æ ¸å¿ƒç‰¹å¾ï¼š**
- ğŸ¤– **åˆ›å»ºä¸»ç®¡æ™ºèƒ½ä½“**ï¼šç”¨äºåè°ƒå¤šä¸ªä¸“ä¸šæ™ºèƒ½ä½“çš„å·¥ä½œã€‚
- ğŸ› ï¸ **åŸºäºå·¥å…·çš„äº¤æ¥**ï¼šåˆ©ç”¨å·¥å…·è°ƒç”¨æœºåˆ¶å®ç°æ™ºèƒ½ä½“ä¹‹é—´çš„é€šä¿¡ä¸ä»»åŠ¡æŒ‡æ´¾ã€‚
- ğŸ“ **çµæ´»çš„å†å²ç®¡ç†**ï¼šæ”¯æŒå¯¹å¯¹è¯å†å²çš„ç²¾ç»†åŒ–æ§åˆ¶ï¼Œä¼˜åŒ–ä¸Šä¸‹æ–‡é•¿åº¦ã€‚

å®‰è£…ä¾èµ–ï¼š
```
uv add langgraph-supervisor langchain-openai
```

ä»¥ä¸Šå‘½ä»¤ä½¿ç”¨ UV å®‰è£… Supervisor ä¸ OpenAI é€‚é…çš„å¿…è¦ä¾èµ–ã€‚è‹¥æ”¹ç”¨ DeepSeekã€Gemini ç­‰æä¾›æ–¹ï¼Œè¯·åœ¨ç¤ºä¾‹ä¸­è°ƒæ•´æ¨¡å‹ä¸å¯†é’¥å‚æ•°ã€‚

ä»¥ä¸‹æ˜¯ä¸€ä¸ªä¸»ç®¡ç®¡ç†ä¸¤åä¸“ä¸šä»£ç†äººï¼ˆæ•°å­¦ä¸“å®¶ä¸ç ”ç©¶ä¸“å®¶ï¼‰çš„å®Œæ•´ç¤ºä¾‹ï¼š

```PYTHON

"""Run the langgraph supervisor sample with DeepSeek model."""
from langchain_openai import ChatOpenAI

from langgraph_supervisor import create_supervisor
from langgraph.prebuilt import create_react_agent

model = ChatOpenAI(
    model="deepseek-chat",
    api_key="sk-...",
    base_url="https://api.deepseek.com"
)

# Create specialized agents

def add(a: float, b: float) -> float:
    """Add two numbers."""
    return a + b

def multiply(a: float, b: float) -> float:
    """Multiply two numbers."""
    return a * b

def web_search(query: str) -> str:
    """Search the web for information."""
    return (
        "Here are the headcounts for each of the FAANG companies in 2024:\n"
        "1. **Facebook (Meta)**: 67,317 employees.\n"
        "2. **Apple**: 164,000 employees.\n"
        "3. **Amazon**: 1,551,000 employees.\n"
        "4. **Netflix**: 14,000 employees.\n"
        "5. **Google (Alphabet)**: 181,269 employees."
    )

math_agent = create_react_agent(
    model=model,
    tools=[add, multiply],
    name="math_expert",
    prompt="You are a math expert. Always use one tool at a time."
)

research_agent = create_react_agent(
    model=model,
    tools=[web_search],
    name="research_expert",
    prompt="You are a world class researcher with access to web search. Do not do any math."
)

# Create supervisor workflow
workflow = create_supervisor(
    [research_agent, math_agent],
    model=model,
    prompt=(
        "You are a team supervisor managing a research expert and a math expert. "
        "For current events, use research_agent. "
        "For math problems, use math_agent."
    )
)

# Compile and run
app = workflow.compile()
result = app.invoke({
    "messages": [
        {
            "role": "user",
            "content": "what's the combined headcount of the FAANG companies in 2024?"
        }
    ]
})

print("\n=== Final Answer ===")
messages = result.get("messages", []) if isinstance(result, dict) else []
if messages:
    last = messages[-1]
    output = getattr(last, "content", str(last))
    print(output)
    print("\n=== Trace ===")
    for i, m in enumerate(messages):
        name = getattr(m, "name", None) or "unknown"
        typ = getattr(m, "type", None) or type(m).__name__
        print(f"{i:02d}. {name} [{typ}]")
else:
    print(result)


```

**æ§åˆ¶å°è¾“å‡ºè§£æ**

è¿è¡Œç¤ºä¾‹åï¼Œæ§åˆ¶å°å°†åŒæ—¶è¾“å‡ºâ€œæœ€ç»ˆç­”æ¡ˆâ€å’Œâ€œä»£ç†è°ƒç”¨è½¨è¿¹ï¼ˆTraceï¼‰â€ã€‚è½¨è¿¹æ¸…æ™°åœ°å±•ç¤ºäº†å„æ™ºèƒ½ä½“åœ¨ä¸»ç®¡è°ƒåº¦ä¸‹çš„åä½œè¿‡ç¨‹ï¼Œè¿™å¯¹äºè°ƒè¯• Prompt å’Œä¼˜åŒ–å·¥å…·ç»„åˆéå¸¸æœ‰å¸®åŠ©ã€‚

```
=== Final Answer ===
Based on the research conducted, the combined headcount of FAANG companies in 2024 is **approximately 1,977,586 employees**.

Here's the breakdown:
- **Meta (Facebook)**: 67,317 employees
- **Apple**: 164,000 employees
- **Amazon**: 1,551,000 employees
- **Netflix**: 14,000 employees
- **Google (Alphabet)**: 181,269 employees

**Total: 1,977,586 employees**

Amazon accounts for the vast majority (over 78%) of FAANG's total workforce, largely due to its massive warehouse and logistics operations. The other four companies combined make up about 22% of the total headcount.

=== Trace ===
00. unknown [human]
01. supervisor [ai]
02. transfer_to_research_expert [tool]
03. research_expert [ai]
04. research_expert [ai]
05. transfer_back_to_supervisor [tool]
06. supervisor [ai]
```

**Full History æ¨¡å¼**

å¦‚æœéœ€è¦ä¿ç•™å®Œæ•´çš„å¯¹è¯ä¸å·¥å…·è°ƒç”¨å†å²ï¼ˆä¾‹å¦‚ç”¨äºå®¡è®¡æˆ–å¤ç›˜ï¼‰ï¼Œå¯å¼€å¯ `full_history` æ¨¡å¼ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨é«˜å¹¶å‘æˆ–é•¿å¯¹è¯åœºæ™¯ä¸‹ï¼Œéœ€ç»“åˆæ‘˜è¦ï¼ˆSummarizationï¼‰ä¸åˆ†æ®µæŒä¹…åŒ–ç­–ç•¥ï¼Œä»¥å¹³è¡¡å­˜å‚¨æˆæœ¬ä¸ç³»ç»Ÿæ€§èƒ½ã€‚

```
workflow = create_supervisor(
    agents=[agent1, agent2],
    output_mode="full_history"
)
```

å¼€å¯åçš„è½¨è¿¹ç¤ºä¾‹ï¼š
```
=== Trace ===
00. unknown [human]
01. supervisor [ai]
02. transfer_to_research_expert [tool]
03. research_expert [ai]
04. web_search [tool]
05. research_expert [ai]
06. web_search [tool]
07. research_expert [ai]
08. web_search [tool]
09. research_expert [ai]
10. web_search [tool]
11. research_expert [ai]
12. web_search [tool]
13. research_expert [ai]
14. web_search [tool]
15. research_expert [ai]
16. research_expert [ai]
17. transfer_back_to_supervisor [tool]
18. supervisor [ai]
```


### Multi-level Hierarchies  å¤šçº§å±‚çº§ç»“æ„

é€šè¿‡â€œä¸»ç®¡ç®¡ç†ä¸»ç®¡â€çš„æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºå¤šçº§å±‚çº§ç³»ç»Ÿï¼ˆMulti-level Hierarchiesï¼‰ã€‚

å½“ä¸šåŠ¡æµç¨‹æå…¶å¤æ‚ï¼Œæ¶‰åŠå¤šä¸ªåºå¤§çš„èŒèƒ½éƒ¨é—¨ï¼ˆå¦‚ç‹¬ç«‹çš„ç ”å‘å›¢é˜Ÿã€å†™ä½œå›¢é˜Ÿï¼‰æ—¶ï¼Œå¯ä»¥é€šè¿‡â€œé¡¶å±‚ä¸»ç®¡â€æ¥åè°ƒå¤šä¸ªâ€œå­ä¸»ç®¡â€ã€‚è¿™ç§ç»“æ„å®ç°äº†æ›´æ¸…æ™°çš„æ¨¡å—è¾¹ç•Œä¸èŒè´£åˆ†ç¦»ï¼Œç±»ä¼¼äºå¤§å‹å…¬å¸çš„ç»„ç»‡æ¶æ„ã€‚

```PYTHON
research_team = create_supervisor(
    [research_agent, math_agent],
    model=model,
    supervisor_name="research_supervisor"
).compile(name="research_team")

writing_team = create_supervisor(
    [writing_agent, publishing_agent],
    model=model,
    supervisor_name="writing_supervisor"
).compile(name="writing_team")

top_level_supervisor = create_supervisor(
    [research_team, writing_team],
    model=model,
    supervisor_name="top_level_supervisor"
).compile(name="top_level_supervisor")
```


### è‡ªå®šä¹‰ä»£ç†ä¸Šä¸‹æ–‡

å¤šæ™ºèƒ½ä½“è®¾è®¡çš„æ ¸å¿ƒåœ¨äº **ä¸Šä¸‹æ–‡å·¥ç¨‹ï¼ˆContext Engineeringï¼‰** â€”â€” å³å†³å®šæ¯ä¸ªæ™ºèƒ½ä½“èƒ½â€œçœ‹åˆ°â€ä»€ä¹ˆä¿¡æ¯ã€‚

ç³»ç»Ÿçš„æ•ˆèƒ½å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºä¸Šä¸‹æ–‡çš„è®¾è®¡ã€‚ç›®æ ‡æ˜¯ç¡®ä¿æ¯ä¸ªæ™ºèƒ½ä½“ï¼ˆæ— è®ºæ˜¯ä½œä¸ºå·¥å…·è¿˜æ˜¯ç‹¬ç«‹è¡ŒåŠ¨è€…ï¼‰éƒ½èƒ½è·å¾—æ‰§è¡Œä»»åŠ¡æ‰€éœ€çš„æœ€å°å¿…è¦æ•°æ®ï¼ŒåŒæ—¶é¿å…æ— å…³ä¿¡æ¯å¸¦æ¥çš„å¹²æ‰°ï¼ˆå™ªå£°ï¼‰ã€‚LangChain æä¾›äº†ç»†ç²’åº¦çš„æ§åˆ¶èƒ½åŠ›ï¼Œå…è®¸å¼€å‘è€…ä¸ºä¸åŒè§’è‰²å®šåˆ¶å·®å¼‚åŒ–çš„æ•°æ®è§†é‡ã€‚

### Adding Memory  æ·»åŠ å†…å­˜

æ‚¨å¯ä»¥ä¸ºæ‚¨çš„ Supervisor å¤šæ™ºèƒ½ä½“ç³»ç»Ÿæ·»åŠ  **çŸ­æœŸè®°å¿†ï¼ˆShort-term Memoryï¼‰** å’Œ **é•¿æœŸè®°å¿†ï¼ˆLong-term Memoryï¼‰**ã€‚

ç”±äº `create_supervisor()` è¿”å›çš„æ˜¯ä¸€ä¸ªéœ€è¦ç¼–è¯‘æ‰èƒ½ä½¿ç”¨çš„ `StateGraph` å®ä¾‹ï¼Œå› æ­¤æ‚¨å¯ä»¥ç›´æ¥å°† `checkpointer`ï¼ˆç”¨äºçŸ­æœŸä¼šè¯ä¿æŒï¼‰æˆ– `store`ï¼ˆç”¨äºé•¿æœŸè®°å¿†å­˜å‚¨ï¼‰ä¼ é€’ç»™ `.compile()` æ–¹æ³•ã€‚è¿™ç§æœºåˆ¶å¯¹äºæ„å»ºèƒ½è®°ä½ç”¨æˆ·åå¥½æˆ–è·¨å¤šè½®å¯¹è¯ä¿æŒè¿è´¯æ€§çš„åº”ç”¨è‡³å…³é‡è¦ã€‚

```
from langgraph.checkpoint.memory import InMemorySaver
from langgraph.store.memory import InMemoryStore

checkpointer = InMemorySaver()
store = InMemoryStore()

model = ...
research_agent = ...
math_agent = ...

workflow = create_supervisor(
    [research_agent, math_agent],
    model=model,
    prompt="You are a team supervisor managing a research expert and a math expert.",
)

# Compile with checkpointer/store
app = workflow.compile(
    checkpointer=checkpointer,
    store=store
)
```

### Customizing handoff tools  è‡ªå®šä¹‰äº¤æ¥å·¥å…·

é»˜è®¤æƒ…å†µä¸‹ï¼ŒSupervisor ä½¿ç”¨é¢„ç½®çš„ `create_handoff_tool` æ¥ç”Ÿæˆäº¤æ¥å·¥å…·ã€‚ä½†åœ¨å¤æ‚åœºæ™¯ä¸‹ï¼Œæ‚¨å¯èƒ½éœ€è¦è‡ªå®šä¹‰è¿™äº›å·¥å…·çš„è¡Œä¸ºã€‚

è‡ªå®šä¹‰äº¤æ¥å·¥å…·èƒ½è®©â€œè§’è‰²åˆ‡æ¢â€æ›´åŠ ç²¾ç¡®ä¸å¯æ§ã€‚ä¾‹å¦‚ï¼š
- æ›´æ”¹å·¥å…·åç§°æˆ–æè¿°ï¼Œä½¿å…¶æ›´ç¬¦åˆç‰¹å®šä¸šåŠ¡è¯­å¢ƒã€‚
- å¢åŠ é¢å¤–çš„å‚æ•°ï¼Œè¦æ±‚ LLM åœ¨äº¤æ¥æ—¶å¡«å†™ï¼ˆå¦‚ï¼šç»™ä¸‹ä¸€ä¸ªæ™ºèƒ½ä½“çš„å…·ä½“ä»»åŠ¡ç®€æŠ¥ï¼‰ã€‚
- è°ƒæ•´ä¼ é€’ç»™å­æ™ºèƒ½ä½“çš„æ•°æ®å†…å®¹ï¼ˆé»˜è®¤ä¼ é€’å®Œæ•´å†å²ï¼Œæ‚¨å¯èƒ½å¸Œæœ›åªä¼ é€’æ‘˜è¦ï¼‰ã€‚

ä»¥ä¸‹æ˜¯å¦‚ä½•å°†è‡ªå®šä¹‰äº¤æ¥å·¥å…·ä¼ é€’ç»™ `create_supervisor` çš„ç¤ºä¾‹ï¼š

```
from langgraph_supervisor import create_handoff_tool
workflow = create_supervisor(
    [research_agent, math_agent],
    tools=[
        create_handoff_tool(agent_name="math_expert", name="assign_to_math_expert", description="Assign task to math expert"),
        create_handoff_tool(agent_name="research_expert", name="assign_to_research_expert", description="Assign task to research expert")
    ],
    model=model,
)
```

**create_handoff_tool å‚æ•°è¯´æ˜**

- `agent_name`: ç›®æ ‡æ™ºèƒ½ä½“çš„åç§°ï¼ˆå¤šæ™ºèƒ½ä½“å›¾ä¸­çš„èŠ‚ç‚¹åï¼‰ã€‚åç§°åº”ç®€æ´æ¸…æ™°ï¼Œé€šå¸¸ä½¿ç”¨è›‡å½¢å‘½åæ³•ï¼ˆsnake_caseï¼‰ã€‚
- `name`: ï¼ˆå¯é€‰ï¼‰äº¤æ¥å·¥å…·çš„åç§°ã€‚é»˜è®¤ä¸º `transfer_to_<agent_name>`ã€‚
- `description`: ï¼ˆå¯é€‰ï¼‰å·¥å…·æè¿°ã€‚é»˜è®¤ä¸º `Ask agent <agent_name> for help`ã€‚
- `add_handoff_messages`: æ˜¯å¦å°†äº¤æ¥åŠ¨ä½œä½œä¸ºæ¶ˆæ¯æ·»åŠ åˆ°å†å²è®°å½•ä¸­ã€‚å¦‚æœè®¾ä¸º `False`ï¼Œäº¤æ¥è¿‡ç¨‹å¯¹ä¸Šä¸‹æ–‡å°†æ˜¯é€æ˜çš„ã€‚

## 4. æ€»ç»“ä¸å±•æœ›

å¤šæ™ºèƒ½ä½“ç³»ç»Ÿï¼ˆMulti-Agent Systemsï¼‰æ ‡å¿—ç€ AI åº”ç”¨å¼€å‘ä»å•ä¸€çš„ Prompt Engineering èµ°å‘äº†æ›´å¤æ‚çš„ System Engineeringã€‚

- **æ¨¡å¼é€‰æ‹©**ï¼šSupervisor æ¨¡å¼æä¾›äº†ç¡®å®šæ€§ä¸å¯æ§æ€§ï¼Œé€‚åˆæµç¨‹æ ‡å‡†åŒ–çš„ä¸šåŠ¡ï¼›è€Œ Handoffs æ¨¡å¼åˆ™èµ‹äºˆäº†ç³»ç»Ÿæ›´å¤§çš„çµæ´»æ€§ï¼Œé€‚åˆæ¢ç´¢æ€§ä¸éçº¿æ€§ä»»åŠ¡ã€‚
- **å¤æ‚åº¦ç®¡ç†**ï¼šéšç€æ™ºèƒ½ä½“æ•°é‡çš„å¢åŠ ï¼Œç³»ç»Ÿçš„è°ƒè¯•ä¸è§‚æµ‹ï¼ˆObservabilityï¼‰å°†å˜å¾—æå…·æŒ‘æˆ˜ã€‚å»ºè®®ç»“åˆ LangSmith ç­‰å·¥å…·ï¼Œå¯¹æ™ºèƒ½ä½“ä¹‹é—´çš„äº¤äº’è½¨è¿¹è¿›è¡Œå¯è§†åŒ–è¿½è¸ªä¸è¯„ä¼°ã€‚
- **æœªæ¥è¶‹åŠ¿**ï¼šæœªæ¥çš„æ™ºèƒ½ä½“æ¶æ„å°†æ›´åŠ å‘ˆç°â€œåˆ†å½¢â€ç‰¹å¾â€”â€”æ¯ä¸ªèŠ‚ç‚¹æ—¢æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ™ºèƒ½ä½“ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªç”±æ›´å°ç²’åº¦æ™ºèƒ½ä½“ç»„æˆçš„å­å›¾ã€‚

é€šè¿‡åˆç†è¿ç”¨ LangGraph æä¾›çš„ç¼–æ’èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºå‡ºæ—¢å…·å¤‡å¹¿åº¦ï¼ˆå¤šé¢†åŸŸä¸“å®¶åä½œï¼‰åˆå…·å¤‡æ·±åº¦ï¼ˆå¤æ‚é€»è¾‘å¤„ç†ï¼‰çš„ä¸‹ä¸€ä»£ AI åº”ç”¨ã€‚

## å‚è€ƒèµ„æ–™

* [Multi-agent](https://docs.langchain.com/oss/python/langchain/multi-agent)
* [Build a supervisor agent](https://docs.langchain.com/oss/python/langchain/supervisor)
* [LangGraph Multi-Agent Supervisor](https://github.com/langchain-ai/langgraph-supervisor-py)